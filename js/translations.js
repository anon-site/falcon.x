// Translations for Arabic and English
const translations = {
    en: {
        // Settings Modal
        settings: 'Settings',
        clearCache: 'Clear Cache',
        clearCacheDesc: 'Clear browser cache and temporary data',
        themeColors: 'Theme Colors',
        language: 'Language',
        
        // Languages
        arabic: 'Arabic',
        english: 'English',
        
        // Theme Names
        default: 'Default',
        ocean: 'Ocean',
        sunset: 'Sunset',
        forest: 'Forest',
        rose: 'Rose',
        
        // Notifications
        cacheCleared: 'Cache cleared successfully!',
        cacheError: 'An error occurred while clearing the cache.',
        themeChanged: 'Theme changed successfully!',
        languageChanged: 'Language changed successfully!',
        
        // Sidebar
        home: 'Home',
        windows: 'Windows',
        programs: 'Programs',
        games: 'Games',
        android: 'Android',
        apps: 'Apps',
        phoneTools: 'Phone Tools',
        frpApps: 'FRP Apps',
        aboutUs: 'About Us',
        version: 'Version',
        allRightsReserved: 'All Rights Reserved',
        
        // Content Headers
        windowsPrograms: 'Windows Programs',
        windowsGames: 'Windows Games',
        androidApps: 'Android Apps',
        androidGames: 'Android Games',
        
        // Filters
        allCategories: 'All Categories',
        allBrands: 'All Brands',
        searchPrograms: 'Search programs...',
        searchGames: 'Search games...',
        searchApps: 'Search apps...',
        searchTools: 'Search tools...',
        searchFrpApps: 'Search FRP apps...',
        
        // Hero Section
        premiumCollection: 'Premium Collection',
        discoverTheBest: 'Discover The Best',
        softwareAndApps: 'Software & Apps',
        heroSubtitle: 'Your trusted platform for downloading premium software, applications, and tools for Windows and Android devices.',
        getStarted: 'Get Started',
        watchDemo: 'Watch Demo',
        
        // Features
        whyChoose: 'Why Choose',
        windowsSoftware: 'Windows Software',
        windowsSoftwareDesc: 'Latest programs and games for Windows platform',
        androidAppsDesc: 'Premium apps and games for Android devices',
        phoneToolsDesc: 'Essential tools for phone management',
        frpSolutions: 'FRP Solutions',
        frpSolutionsDesc: 'FRP unlock tools for all phone brands',
        regularUpdates: 'Regular Updates',
        regularUpdatesDesc: 'Constantly updated with latest versions',
        safeAndSecure: 'Safe & Secure',
        safeAndSecureDesc: 'All downloads verified and tested',
        
        // About Section
        aboutFalconX: 'About Falcon X',
        aboutDescription: 'Falcon X is your premier destination for high-quality software, applications, and tools. We provide a curated collection of programs and apps for both Windows and Android platforms.',
        safeDownloads: 'All downloads are verified and safe',
        latestVersions: 'Latest versions and updates',
        fastDownloads: 'Fast Downloads',
        highSpeedServers: 'High-speed download servers',
        
        // Common
        download: 'Download',
        viewDetails: 'View Details',
        close: 'Close',
        cacheNote: 'Clears local browser data only'
    },
    ar: {
        // Settings Modal
        settings: 'الإعدادات',
        clearCache: 'مسح الذاكرة المؤقتة',
        clearCacheDesc: 'مسح ذاكرة التخزين المؤقت والبيانات المؤقتة',
        themeColors: 'ألوان السمة',
        language: 'اللغة',
        
        // Languages
        arabic: 'العربية',
        english: 'الإنجليزية',
        
        // Theme Names
        default: 'افتراضي',
        ocean: 'محيط',
        sunset: 'غروب',
        forest: 'غابة',
        rose: 'وردي',
        
        // Notifications
        cacheCleared: 'تم مسح الذاكرة المرئية بنجاح!',
        cacheError: 'حدث خطأ أثناء مسح الذاكرة المؤقتة.',
        themeChanged: 'تم تغيير السمة بنجاح!',
        languageChanged: 'تم تغيير اللغة بنجاح!',
        
        // Sidebar
        home: 'الرئيسية',
        windows: 'ويندوز',
        programs: 'البرامج',
        games: 'الألعاب',
        android: 'أندرويد',
        apps: 'التطبيقات',
        phoneTools: 'أدوات الهاتف',
        frpApps: 'تطبيقات FRP',
        aboutUs: 'من نحن',
        version: 'الإصدار',
        allRightsReserved: 'جميع الحقوق محفوظة',
        
        // Content Headers
        windowsPrograms: 'برامج ويندوز',
        windowsGames: 'ألعاب ويندوز',
        androidApps: 'تطبيقات أندرويد',
        androidGames: 'ألعاب أندرويد',
        
        // Filters
        allCategories: 'جميع الفئات',
        allBrands: 'جميع العلامات',
        searchPrograms: 'بحث عن برامج...',
        searchGames: 'بحث عن ألعاب...',
        searchApps: 'بحث عن تطبيقات...',
        searchTools: 'بحث عن أدوات...',
        searchFrpApps: 'بحث عن تطبيقات FRP...',
        
        // Hero Section
        premiumCollection: 'مجموعة مميزة',
        discoverTheBest: 'اكتشف الأفضل',
        softwareAndApps: 'البرامج والتطبيقات',
        heroSubtitle: 'منصتك الموثوقة لتحميل البرامج والتطبيقات والأدوات المميزة لأجهزة ويندوز وأندرويد.',
        getStarted: 'ابدأ الآن',
        watchDemo: 'شاهد العرض',
        
        // Features
        whyChoose: 'لماذا تختار',
        windowsSoftware: 'برامج ويندوز',
        windowsSoftwareDesc: 'أحدث البرامج والألعاب لنظام ويندوز',
        androidAppsDesc: 'تطبيقات وألعاب مميزة لأجهزة أندرويد',
        phoneToolsDesc: 'أدوات أساسية لإدارة الهاتف',
        frpSolutions: 'حلول FRP',
        frpSolutionsDesc: 'أدوات فتح FRP لجميع ماركات الهواتف',
        regularUpdates: 'تحديثات منتظمة',
        regularUpdatesDesc: 'يتم التحديث باستمرار بأحدث الإصدارات',
        safeAndSecure: 'آمن ومضمون',
        safeAndSecureDesc: 'جميع التنزيلات تم التحقق منها واختبارها',
        
        // About Section
        aboutFalconX: 'حول Falcon X',
        aboutDescription: 'Falcon X هي وجهتك الرئيسية للبرامج والتطبيقات والأدوات عالية الجودة. نحن نقدم مجموعة منتقاة من البرامج والتطبيقات لكل من منصات ويندوز وأندرويد.',
        safeDownloads: 'جميع التنزيلات تم التحقق منها وآمنة',
        latestVersions: 'أحدث الإصدارات والتحديثات',
        fastDownloads: 'تنزيلات سريعة',
        highSpeedServers: 'خوادم تنزيل عالية السرعة',
        
        // Common
        download: 'تحميل',
        viewDetails: 'عرض التفاصيل',
        close: 'إغلاق',
        cacheNote: 'يمسح بيانات المتصفح المحلية فقط'
    }
};

// Get current language from localStorage or default to English
let currentLanguage = localStorage.getItem('language') || 'en';

// Function to get translation
function t(key) {
    return translations[currentLanguage][key] || key;
}

// Function to change language
function changeLanguage(lang) {
    currentLanguage = lang;
    localStorage.setItem('language', lang);
    
    // Update HTML lang attribute
    document.documentElement.lang = lang;
    
    // Update direction for RTL languages
    if (lang === 'ar') {
        document.documentElement.dir = 'rtl';
        document.body.classList.add('rtl');
        
        // Load Google Translate for Arabic
        loadGoogleTranslate();
    } else {
        document.documentElement.dir = 'ltr';
        document.body.classList.remove('rtl');
        
        // Remove Google Translate if switching to English
        removeGoogleTranslate();
    }
    
    // Update all translatable elements
    updateTranslations();
}

// Function to load Google Translate
function loadGoogleTranslate() {
    // Check if already translated
    if (document.documentElement.classList.contains('translated-rtl')) {
        return;
    }
    
    // Check if Google Translate is already loaded
    if (window.google && window.google.translate) {
        // If already loaded, just trigger translation
        setTimeout(() => {
            triggerGoogleTranslate();
        }, 300);
        return;
    }
    
    // Create hidden container for Google Translate widget first
    if (!document.getElementById('google_translate_element')) {
        const translateDiv = document.createElement('div');
        translateDiv.id = 'google_translate_element';
        translateDiv.style.cssText = 'position: fixed; top: -1000px; left: -1000px; visibility: hidden;';
        document.body.appendChild(translateDiv);
    }
    
    // Initialize Google Translate callback
    window.googleTranslateElementInit = function() {
        new google.translate.TranslateElement({
            pageLanguage: 'en',
            includedLanguages: 'ar',
            autoDisplay: false,
            layout: google.translate.TranslateElement.InlineLayout.SIMPLE
        }, 'google_translate_element');
        
        // Wait for widget to be ready then trigger translation
        const checkWidget = setInterval(() => {
            const selectElement = document.querySelector('.goog-te-combo');
            if (selectElement) {
                clearInterval(checkWidget);
                setTimeout(() => {
                    triggerGoogleTranslate();
                }, 500);
            }
        }, 100);
    };
    
    // Add Google Translate script if not already added
    if (!document.getElementById('google-translate-script')) {
        const script = document.createElement('script');
        script.id = 'google-translate-script';
        script.src = 'https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
        script.async = true;
        document.head.appendChild(script);
    }
}

// Function to trigger Google Translate to Arabic
function triggerGoogleTranslate() {
    const selectElement = document.querySelector('.goog-te-combo');
    if (selectElement && selectElement.value !== 'ar') {
        selectElement.value = 'ar';
        selectElement.dispatchEvent(new Event('change'));
        document.documentElement.classList.add('translated-rtl');
        
        // Hide Google Translate toolbar
        setTimeout(() => {
            const toolbar = document.querySelector('.goog-te-banner-frame');
            if (toolbar) {
                toolbar.style.display = 'none';
            }
            // Adjust body padding if added by Google Translate
            document.body.style.top = '0px';
        }, 1000);
    }
}

// Function to remove Google Translate
function removeGoogleTranslate() {
    document.documentElement.classList.remove('translated-rtl');
    
    // Check if translation is active
    const translateElement = document.querySelector('.goog-te-combo');
    if (translateElement && translateElement.value === 'ar') {
        // Reset to original language
        translateElement.value = '';
        translateElement.dispatchEvent(new Event('change'));
        
        // Reload page after short delay to fully reset
        setTimeout(() => {
            location.reload();
        }, 300);
    }
}

// Function to update all translations on the page
function updateTranslations() {
    // Update elements with data-translate attribute
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        element.textContent = t(key);
    });
    
    // Update placeholder attributes
    document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
        const key = element.getAttribute('data-translate-placeholder');
        element.placeholder = t(key);
    });
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', () => {
    changeLanguage(currentLanguage);
    
    // If language is Arabic, load Google Translate
    if (currentLanguage === 'ar') {
        loadGoogleTranslate();
    }
});
