<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Falcon X</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="icon" type="image/png" href="images/6e89058a-eeee-45f5-9585-d26b3fb6fefc copy.png">
</head>
<body class="admin-page">
    <!-- Sidebar -->
    <aside class="admin-sidebar" id="adminSidebar">
        <div class="sidebar-header">
            <img src="images/6e89058a-eeee-45f5-9585-d26b3fb6fefc copy.png" alt="Falcon X" class="sidebar-logo">
            <h2>لوحة التحكم</h2>
            <button class="sidebar-toggle-btn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        
        <nav class="sidebar-nav">
            <a href="#dashboard" class="nav-item active" onclick="showSection('dashboard')">
                <i class="fas fa-home"></i>
                <span>الرئيسية</span>
            </a>
            <a href="#apps-management" class="nav-item" onclick="showSection('apps-management')">
                <i class="fas fa-mobile-alt"></i>
                <span>إدارة البرامج والتطبيقات</span>
            </a>
            <a href="#navigation-management" class="nav-item" onclick="showSection('navigation-management')">
                <i class="fas fa-bars"></i>
                <span>إدارة التبويبات</span>
            </a>
            <a href="#site-settings" class="nav-item" onclick="showSection('site-settings')">
                <i class="fas fa-cog"></i>
                <span>إعدادات الموقع</span>
            </a>
            <a href="#colors-management" class="nav-item" onclick="showSection('colors-management')">
                <i class="fas fa-palette"></i>
                <span>الألوان والتصميم</span>
            </a>
            <a href="#images-management" class="nav-item" onclick="showSection('images-management')">
                <i class="fas fa-images"></i>
                <span>إدارة الصور</span>
            </a>
            <a href="#github-settings" class="nav-item" onclick="showSection('github-settings')">
                <i class="fab fa-github"></i>
                <span>إعدادات GitHub</span>
            </a>
        </nav>
        
        <div class="sidebar-footer">
            <button class="btn btn-danger btn-block" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>تسجيل الخروج</span>
            </button>
        </div>
    </aside>
    
    <!-- Main Content -->
    <main class="admin-main">
        <header class="admin-header">
            <button class="mobile-menu-btn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
            <h1 class="page-title">الرئيسية</h1>
            <div class="header-actions">
                <div id="syncStatus" style="display: inline-flex; align-items: center; padding: 0.5rem 1rem; background: #1e2746; border-radius: 8px; margin-left: 0.5rem;">
                    <i class="fas fa-check-circle" style="color: #10b981; margin-left: 0.5rem;"></i>
                    <span style="font-size: 0.85rem; color: #fff;">جاهز للحفظ</span>
                </div>
                <button class="btn btn-icon" onclick="manualSaveToGitHub()" title="حفظ التغييرات على GitHub" style="background: #10b981; color: #fff;">
                    <i class="fas fa-save"></i>
                    حفظ
                </button>
                <button class="btn btn-icon" onclick="document.getElementById('importFile').click()" title="استيراد ملف data.js">
                    <i class="fas fa-upload"></i>
                    استيراد
                </button>
                <button class="btn btn-icon" onclick="exportToDataJS()" title="تصدير البيانات">
                    <i class="fas fa-download"></i>
                    تصدير
                </button>
                <button class="btn btn-icon" onclick="window.open('index.html', '_blank')">
                    <i class="fas fa-external-link-alt"></i>
                    عرض الموقع
                </button>
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span id="adminUsername">Admin</span>
                </div>
            </div>
        </header>
        
        <div class="admin-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            <i class="fab fa-windows"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="windowsCount">0</h3>
                            <p>برامج Windows</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            <i class="fab fa-android"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="androidCount">0</h3>
                            <p>تطبيقات Android</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            <i class="fas fa-unlock-alt"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="frpToolsCount">0</h3>
                            <p>أدوات FRP</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="frpAppsCount">0</h3>
                            <p>تطبيقات FRP</p>
                        </div>
                    </div>
                </div>
                
                <div class="quick-actions">
                    <h2>إجراءات سريعة</h2>
                    <div class="actions-grid">
                        <button class="action-card" onclick="showSection('apps-management'); addNewApp('windows')">
                            <i class="fab fa-windows"></i>
                            <span>إضافة برنامج Windows</span>
                        </button>
                        <button class="action-card" onclick="showSection('apps-management'); addNewApp('android')">
                            <i class="fab fa-android"></i>
                            <span>إضافة تطبيق Android</span>
                        </button>
                        <button class="action-card" onclick="showSection('apps-management'); addNewApp('frp-tools')">
                            <i class="fas fa-unlock-alt"></i>
                            <span>إضافة أداة FRP</span>
                        </button>
                        <button class="action-card" onclick="showSection('site-settings')">
                            <i class="fas fa-cog"></i>
                            <span>تعديل الإعدادات</span>
                        </button>
                        <button class="action-card" onclick="document.getElementById('importFile').click()">
                            <i class="fas fa-upload"></i>
                            <span>استيراد data.js</span>
                        </button>
                        <button class="action-card" onclick="exportToDataJS()">
                            <i class="fas fa-download"></i>
                            <span>تصدير البيانات</span>
                        </button>
                        <button class="action-card" onclick="reimportFromDataJS()">
                            <i class="fas fa-sync-alt"></i>
                            <span>إعادة من الملف الأصلي</span>
                        </button>
                    </div>
                </div>
            </section>
            
            <!-- Apps Management Section -->
            <section id="apps-management" class="content-section">
                <div class="section-header">
                    <h2>إدارة البرامج والتطبيقات</h2>
                </div>
                
                <div class="tabs">
                    <button class="tab-btn active" onclick="switchTab('windows')">برامج Windows</button>
                    <button class="tab-btn" onclick="switchTab('android')">تطبيقات Android</button>
                    <button class="tab-btn" onclick="switchTab('frp-tools')">أدوات FRP</button>
                    <button class="tab-btn" onclick="switchTab('frp-apps')">تطبيقات FRP</button>
                </div>
                
                <div class="tab-content">
                    <!-- Windows Software Tab -->
                    <div id="windows-tab" class="tab-pane active">
                        <div class="table-actions">
                            <button class="btn btn-primary" onclick="openAppModal('windows')">
                                <i class="fas fa-plus"></i>
                                إضافة برنامج جديد
                            </button>
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" placeholder="بحث..." onkeyup="filterApps('windows', this.value)">
                            </div>
                        </div>
                        <div id="windows-list" class="apps-table"></div>
                    </div>
                    
                    <!-- Android Apps Tab -->
                    <div id="android-tab" class="tab-pane">
                        <div class="table-actions">
                            <button class="btn btn-primary" onclick="openAppModal('android')">
                                <i class="fas fa-plus"></i>
                                إضافة تطبيق جديد
                            </button>
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" placeholder="بحث..." onkeyup="filterApps('android', this.value)">
                            </div>
                        </div>
                        <div id="android-list" class="apps-table"></div>
                    </div>
                    
                    <!-- FRP Tools Tab -->
                    <div id="frp-tools-tab" class="tab-pane">
                        <div class="table-actions">
                            <button class="btn btn-primary" onclick="openAppModal('frp-tools')">
                                <i class="fas fa-plus"></i>
                                إضافة أداة جديدة
                            </button>
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" placeholder="بحث..." onkeyup="filterApps('frp-tools', this.value)">
                            </div>
                        </div>
                        <div id="frp-tools-list" class="apps-table"></div>
                    </div>
                    
                    <!-- FRP Apps Tab -->
                    <div id="frp-apps-tab" class="tab-pane">
                        <div class="table-actions">
                            <button class="btn btn-primary" onclick="openAppModal('frp-apps')">
                                <i class="fas fa-plus"></i>
                                إضافة تطبيق جديد
                            </button>
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" placeholder="بحث..." onkeyup="filterApps('frp-apps', this.value)">
                            </div>
                        </div>
                        <div id="frp-apps-list" class="apps-table"></div>
                    </div>
                </div>
            </section>
            
            <!-- Navigation Management Section -->
            <section id="navigation-management" class="content-section">
                <div class="section-header">
                    <h2>إدارة التبويبات والصفحات</h2>
                    <button class="btn btn-primary" onclick="openNavModal()">
                        <i class="fas fa-plus"></i>
                        إضافة تبويب جديد
                    </button>
                </div>
                <div id="navigation-list" class="navigation-list"></div>
            </section>
            
            <!-- Site Settings Section -->
            <section id="site-settings" class="content-section">
                <div class="section-header">
                    <h2>إعدادات الموقع</h2>
                </div>
                
                <form id="siteSettingsForm" class="settings-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="siteTitle">عنوان الموقع</label>
                            <input type="text" id="siteTitle" name="siteTitle" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="siteVersion">إصدار الموقع</label>
                            <input type="text" id="siteVersion" name="siteVersion" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="siteCopyright">حقوق النشر</label>
                            <input type="text" id="siteCopyright" name="siteCopyright" required>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="siteDescription">وصف الموقع</label>
                            <textarea id="siteDescription" name="siteDescription" rows="3" required></textarea>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="siteMission">رسالة الموقع</label>
                            <textarea id="siteMission" name="siteMission" rows="4" required></textarea>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i>
                        حفظ التغييرات
                    </button>
                </form>
            </section>
            
            <!-- Colors Management Section -->
            <section id="colors-management" class="content-section">
                <div class="section-header">
                    <h2>الألوان والتصميم</h2>
                </div>
                
                <form id="colorsForm" class="settings-form">
                    <div class="color-grid">
                        <div class="color-group">
                            <label for="primaryColor">اللون الأساسي</label>
                            <div class="color-input">
                                <input type="color" id="primaryColor" name="primaryColor">
                                <input type="text" id="primaryColorHex" placeholder="#667eea">
                            </div>
                        </div>
                        
                        <div class="color-group">
                            <label for="secondaryColor">اللون الثانوي</label>
                            <div class="color-input">
                                <input type="color" id="secondaryColor" name="secondaryColor">
                                <input type="text" id="secondaryColorHex" placeholder="#764ba2">
                            </div>
                        </div>
                        
                        <div class="color-group">
                            <label for="accentColor">لون التمييز</label>
                            <div class="color-input">
                                <input type="color" id="accentColor" name="accentColor">
                                <input type="text" id="accentColorHex" placeholder="#f093fb">
                            </div>
                        </div>
                        
                        <div class="color-group">
                            <label for="backgroundColor">لون الخلفية</label>
                            <div class="color-input">
                                <input type="color" id="backgroundColor" name="backgroundColor">
                                <input type="text" id="backgroundColorHex" placeholder="#0a0e27">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i>
                            حفظ الألوان
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="resetColors()">
                            <i class="fas fa-undo"></i>
                            استعادة الافتراضي
                        </button>
                    </div>
                </form>
            </section>
            
            <!-- Images Management Section -->
            <section id="images-management" class="content-section">
                <div class="section-header">
                    <h2>إدارة صور الموقع</h2>
                </div>
                
                <div class="images-grid">
                    <div class="image-card">
                        <h3>شعار الموقع</h3>
                        <div class="image-preview" id="logoPreview">
                            <img src="images/6e89058a-eeee-45f5-9585-d26b3fb6fefc copy.png" alt="Logo">
                        </div>
                        <input type="file" id="logoInput" accept="image/*" onchange="previewImage('logo', this)">
                        <button class="btn btn-primary" onclick="document.getElementById('logoInput').click()">
                            <i class="fas fa-upload"></i>
                            تغيير الشعار
                        </button>
                    </div>
                    
                    <div class="image-card">
                        <h3>صورة Hero</h3>
                        <div class="image-preview" id="heroPreview">
                            <img src="images/X.png" alt="Hero">
                        </div>
                        <input type="file" id="heroInput" accept="image/*" onchange="previewImage('hero', this)">
                        <button class="btn btn-primary" onclick="document.getElementById('heroInput').click()">
                            <i class="fas fa-upload"></i>
                            تغيير الصورة
                        </button>
                    </div>
                    
                    <div class="image-card">
                        <h3>أيقونة المفضلة</h3>
                        <div class="image-preview" id="faviconPreview">
                            <img src="images/6e89058a-eeee-45f5-9585-d26b3fb6fefc copy.png" alt="Favicon">
                        </div>
                        <input type="file" id="faviconInput" accept="image/*" onchange="previewImage('favicon', this)">
                        <button class="btn btn-primary" onclick="document.getElementById('faviconInput').click()">
                            <i class="fas fa-upload"></i>
                            تغيير الأيقونة
                        </button>
                    </div>
                </div>
            </section>
            
            <!-- GitHub Settings Section -->
            <section id="github-settings" class="content-section">
                <div class="section-header">
                    <h2>إعدادات GitHub</h2>
                    <p style="color: #888; font-size: 0.9rem; margin-top: 0.5rem;">
                        قم بإعداد GitHub API للحفظ التلقائي للبيانات على repository الخاص بك
                    </p>
                </div>
                
                <div class="alert" style="background: #1e2746; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; border-left: 4px solid #667eea;">
                    <h3 style="margin: 0 0 0.5rem; color: #667eea; font-size: 1rem;">
                        <i class="fas fa-info-circle"></i> كيفية الحصول على Personal Access Token:
                    </h3>
                    <ol style="margin: 0.5rem 0; padding-right: 1.5rem; line-height: 1.8;">
                        <li>اذهب إلى <a href="https://github.com/settings/tokens" target="_blank" style="color: #667eea;">GitHub Settings → Tokens</a></li>
                        <li>اضغط "Generate new token" → "Generate new token (classic)"</li>
                        <li>اختر Scope: <strong>repo</strong> (كل الصلاحيات)</li>
                        <li>احفظ الـ Token في مكان آمن</li>
                        <li><strong>Repository:</strong> بصيغة username/repository-name</li>
                    </ol>
                </div>
                
                <form id="githubSettingsForm" class="settings-form">
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="githubToken">
                                <i class="fas fa-key"></i> Personal Access Token*
                            </label>
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx" required style="flex: 1;">
                                <button type="button" class="btn btn-primary" onclick="fetchReposFromToken()" style="white-space: nowrap;">
                                    <i class="fas fa-sync"></i>
                                    جلب المستودعات
                                </button>
                            </div>
                            <small style="color: #888; display: block; margin-top: 0.3rem;">
                                سيتم حفظ الـ Token محلياً في متصفحك فقط. اضغط "جلب المستودعات" بعد إدخال التوكن
                            </small>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="githubRepo">
                                <i class="fas fa-folder"></i> اسم الـ Repository*
                            </label>
                            <select id="githubRepo" required style="width: 100%; padding: 0.75rem; border: 1px solid rgba(255,255,255,0.1); background: #1e2746; color: #fff; border-radius: 8px; font-size: 0.95rem;">
                                <option value="" style="background: #1e2746; color: #888;">أدخل التوكن أولاً لجلب المستودعات...</option>
                            </select>
                            <small style="color: #888; display: block; margin-top: 0.3rem;">
                                سيتم عرض جميع المستودعات الخاصة بك بعد إدخال التوكن
                            </small>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="githubBranch">
                                <i class="fas fa-code-branch"></i> اسم الـ Branch
                            </label>
                            <input type="text" id="githubBranch" value="main" required>
                        </div>
                    </div>
                    
                    <div class="form-actions" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i>
                            حفظ الإعدادات
                        </button>
                        <button type="button" class="btn btn-primary" onclick="testGitHubConnection()">
                            <i class="fas fa-plug"></i>
                            اختبار الاتصال
                        </button>
                        <button type="button" class="btn btn-info" onclick="syncToGitHub()">
                            <i class="fas fa-sync"></i>
                            مزامنة البيانات الآن
                        </button>
                    </div>
                </form>
                
                <div id="githubStatus" style="margin-top: 1.5rem; padding: 1rem; border-radius: 8px; display: none;"></div>
            </section>
        </div>
    </main>
    
    <!-- App Modal -->
    <div id="appModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">إضافة برنامج جديد</h2>
                <button class="close-btn" onclick="closeAppModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="appForm">
                <input type="hidden" id="appId">
                <input type="hidden" id="appType">
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="appName">اسم البرنامج/التطبيق*</label>
                        <input type="text" id="appName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="appCategory">الفئة*</label>
                        <select id="appCategory" required>
                            <option value="">اختر الفئة</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="appVersion">الإصدار*</label>
                        <input type="text" id="appVersion" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="appSize">الحجم*</label>
                        <input type="text" id="appSize" placeholder="مثال: 25 MB" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="appRating">التقييم (1-5)*</label>
                        <input type="number" id="appRating" min="1" max="5" step="0.1" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="appDownloads">عدد التحميلات*</label>
                        <input type="text" id="appDownloads" placeholder="مثال: 10K+" required>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="appDescription">الوصف*</label>
                        <textarea id="appDescription" rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="appIcon">رابط الأيقونة</label>
                        <input type="url" id="appIcon" placeholder="https://...">
                    </div>
                    
                    <div class="form-group">
                        <label for="appDownloadLink">رابط التحميل*</label>
                        <input type="url" id="appDownloadLink" required>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="appFeatures">المميزات (كل ميزة في سطر)</label>
                        <textarea id="appFeatures" rows="4" placeholder="ميزة 1&#10;ميزة 2&#10;ميزة 3"></textarea>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i>
                        حفظ
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeAppModal()">
                        <i class="fas fa-times"></i>
                        إلغاء
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Navigation Modal -->
    <div id="navModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="navModalTitle">إضافة تبويب جديد</h2>
                <button class="close-btn" onclick="closeNavModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="navForm">
                <input type="hidden" id="navId">
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="navTitle">عنوان التبويب*</label>
                        <input type="text" id="navTitle" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="navIcon">أيقونة Font Awesome*</label>
                        <input type="text" id="navIcon" placeholder="fas fa-home" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="navLink">رابط الصفحة*</label>
                        <input type="text" id="navLink" placeholder="#page-id" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="navOrder">الترتيب*</label>
                        <input type="number" id="navOrder" min="1" required>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>
                            <input type="checkbox" id="navActive">
                            <span>مفعل</span>
                        </label>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i>
                        حفظ
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeNavModal()">
                        <i class="fas fa-times"></i>
                        إلغاء
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <div class="toast" id="toast"></div>
    
    <!-- Hidden file input for importing data.js -->
    <input type="file" id="importFile" accept=".js" style="display: none;" onchange="handleImportFile(event)">
    
    <script src="js/data.js"></script>
    <script src="js/github-api.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>
